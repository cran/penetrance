<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="BayesMendel Lab" />


<title>Using penetrance</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Using penetrance</h1>
<h4 class="author">BayesMendel Lab</h4>



<p>The R package <code>penetrance</code> provides an estimation of
age-specific penetrance for complex family-based studies in a format
compatible with with the PanelPRO R package.</p>
<p>This vignette demonstrates the process of age imputation and
penetrance estimation using the<code>penetrance</code> package based on
family data and user-specified inputs.</p>
<div id="data" class="section level3">
<h3>Data</h3>
<p>The user must specify the <code>pedigree</code> argument as a data
frame that contains the family data (see <code>test_family_1</code>).
The family data must be in the correct format with the following
columns:</p>
<ul>
<li><p><code>ID</code>: A numeric value representing the unique
identifier for each individual. There should be no duplicated
entries.</p></li>
<li><p><code>Sex</code>: A numeric value where <code>0</code> indicates
female and <code>1</code> indicates male. Missing entries are not
currently supported.</p></li>
<li><p><code>MotherID</code>: A numeric value representing the unique
identifier for an individual’s mother.</p></li>
<li><p><code>FatherID</code>: A numeric value representing the unique
identifier for an individual’s father.</p></li>
<li><p><code>isProband</code>: A numeric value where <code>1</code>
indicates the individual is a proband and <code>0</code>
otherwise.</p></li>
<li><p><code>CurAge</code>: A numeric value indicating the age of
censoring (current age if the person is alive or age at death if the
person is deceased). Allowed ages range from <code>1</code> to
<code>94</code>.</p></li>
<li><p><code>isAff</code>: A numeric value indicating the affection
status of cancer, with <code>1</code> for diagnosed individuals and
<code>0</code> otherwise. Missing entries are not supported.</p></li>
<li><p><code>Age</code>: A numeric value indicating the age of cancer
diagnosis, encoded as <code>NA</code> if the individual was not
diagnosed. Allowed ages range from <code>1</code> to
<code>94</code>.</p></li>
<li><p><code>Geno</code>: A column for germline testing or tumor marker
testing results. Positive results should be coded as <code>1</code>,
negative results as <code>0</code>, and unknown results as
<code>NA</code> or left empty.</p></li>
</ul>
</div>
<div id="age-imputation" class="section level2">
<h2>Age Imputation</h2>
<p>The PenEsim also includes an option for automatic age imputation
<code>AgeImputation</code>. The imputation of ages is performed based on
the individual’s affected status (<code>aff</code>), sex
(<code>sex</code>), and their degree of relationship to the proband, who
is a carrier of the pathogenic variant (PV).</p>
<p>To calculate the degree of relationship to the proband, we use the
kinship matrix from the pedigree data. The degree of relationship
between two individuals is twice the kinship coefficient. For affected
individuals (<code>aff = 1</code>), if a randomly drawn value is less
than the relationship probability, the age is drawn from a Weibull
distribution. The Weibull distribution parameters for males and females
are <span class="math inline">\((\alpha, \beta, \delta)\)</span>. The
quantile function of the Weibull distribution is used to draw the ages
(separately for males and females). If the random draw exceeds the
relationship probability, the age is drawn from the SEER data using the
inverse CDF method. In this case, the individual is assumed to be a
non-carrier of the PV. To calculate the empirical density for
non-affected individuals, filter the dataset to include only
non-affected individuals and estimate the density of their ages. Then
randomly draw an age from this distribution for non-affected
individuals.</p>
</div>
<div id="estimation-approach" class="section level2">
<h2>Estimation Approach</h2>
<p>The estimation assumes a Mendelian model with a single biallelic
locus. The main function <code>penetrance</code> implements a Bayesian
approach to estimate the parameters of the carrier penetrance function.
The estimation routine employs an Adaptive Metropolis Hastings (MH)
algorithm based on Haario et al., (2001). We build on existing software
implementations of the Elston-Stewart peeling algorithm in the R package
clipp to efficiently compute likelihoods.</p>
<p>To model the penetrance curve we choose the Weibull distribution
which is widely used in reliability engineering and survival analysis.
To provide further flexibility we extend the standard Weibull
distribution to four parameters with an additional threshold parameter
(<span class="math inline">\(\delta\)</span>) to move the distribution
along the age axis and an asymptote parameter (<span class="math inline">\(0 &lt; \gamma &lt; 1\)</span>) which allows for
incomplete penetrance and is interpreted as the lifetime probability of
developing cancer. Hence, we have a vector of parameters <span class="math inline">\(\theta = (\alpha, \beta, \gamma, \delta)\)</span>.
Specifically, we model the density <span class="math inline">\(f\)</span> and corresponding cumulative
distribution functions <span class="math inline">\(F\)</span> as:</p>
<p><span class="math display">\[
f(x; \alpha, \beta, \delta, \gamma) = \begin{cases}
\gamma \left( \frac{\alpha}{\beta} \left( \frac{x - \delta}{\beta}
\right)^{\alpha - 1} e^{ -\left( \frac{x - \delta}{\beta} \right)^\alpha
} \right) &amp; x \geq \delta \\
0 &amp; x &lt; \delta
\end{cases}
\]</span> The MCMC estimation approach allows us to sample from the
posterior distribution in an efficient way in order to infer the
estimates of the parameters from the Weibull distribution.</p>
</div>
<div id="prior-specification" class="section level2">
<h2>Prior Specification</h2>
<p>To run the MCMC algorithm, the prior distributions for <span class="math inline">\(\theta = (\alpha, \beta, \gamma, \delta)\)</span>
need to be specified. The package provides the user with a flexible
approach to prior specification, balancing customization with an
easy-to-use workflow. The following settings for the prior distribution
specification are available: - Default: The default setting employs
pre-specified, uninformative priors. - Custom Parameters: The user can
tune the parameters of the default setting directly by overwriting the
parameters in the prior_params_default object. - Prior Elicitation from
Existing Studies: The user can input data from previous penetrance
studies to automatically elicit customized priors. The default setting
is adjusted to reflect the additional information based on the provided
inputs.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="co"># The default prior </span></span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a>prior_params_default <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a>    <span class="at">asymptote =</span> <span class="fu">list</span>(<span class="at">g1 =</span> <span class="dv">1</span>, <span class="at">g2 =</span> <span class="dv">1</span>),</span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a>    <span class="at">threshold =</span> <span class="fu">list</span>(<span class="at">min =</span> <span class="dv">15</span>, <span class="at">max =</span> <span class="dv">35</span>),</span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a>    <span class="at">median =</span> <span class="fu">list</span>(<span class="at">m1 =</span> <span class="dv">2</span>, <span class="at">m2 =</span> <span class="dv">2</span>),</span>
<span id="cb1-6"><a href="#cb1-6" tabindex="-1"></a>    <span class="at">first_quartile =</span> <span class="fu">list</span>(<span class="at">q1 =</span> <span class="dv">6</span>, <span class="at">q2 =</span> <span class="dv">3</span>)</span>
<span id="cb1-7"><a href="#cb1-7" tabindex="-1"></a>)</span>
<span id="cb1-8"><a href="#cb1-8" tabindex="-1"></a></span>
<span id="cb1-9"><a href="#cb1-9" tabindex="-1"></a>distribution_data_test <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb1-10"><a href="#cb1-10" tabindex="-1"></a>  <span class="at">row.names =</span> <span class="fu">c</span>(<span class="st">&quot;min&quot;</span>, <span class="st">&quot;first_quartile&quot;</span>, <span class="st">&quot;median&quot;</span>, <span class="st">&quot;max&quot;</span>),</span>
<span id="cb1-11"><a href="#cb1-11" tabindex="-1"></a>  <span class="at">age =</span> <span class="fu">c</span>(<span class="cn">NA</span>, <span class="cn">NA</span>, <span class="cn">NA</span>, <span class="cn">NA</span>),</span>
<span id="cb1-12"><a href="#cb1-12" tabindex="-1"></a>  <span class="at">at_risk =</span> <span class="fu">c</span>(<span class="cn">NA</span>, <span class="cn">NA</span>, <span class="cn">NA</span>, <span class="cn">NA</span>)</span>
<span id="cb1-13"><a href="#cb1-13" tabindex="-1"></a>)</span></code></pre></div>
</div>
<div id="estimation-using-penetrance" class="section level2">
<h2>Estimation using penetrance</h2>
<p>There are a few ways in which a user can specify how the estimation
approach is run. Available options are:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="co">#&#39; @param twins A list specifying identical twins or triplets in the family. For example, to indicate that &quot;ora024&quot; and &quot;ora027&quot; are identical twins, and &quot;aey063&quot; and &quot;aey064&quot; are identical twins, use the following format: `twins &lt;- list(c(&quot;ora024&quot;, &quot;ora027&quot;), c(&quot;aey063&quot;, &quot;aey064&quot;))`.</span></span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a><span class="co">#&#39; @param n_chains Integer, the number of chains for parallel computation. Default is 1.</span></span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a><span class="co">#&#39; @param n_iter_per_chain Integer, the number of iterations for each chain. Default is 10000.</span></span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a><span class="co">#&#39; @param ncores Integer, the number of cores for parallel computation. Default is 6.</span></span>
<span id="cb2-5"><a href="#cb2-5" tabindex="-1"></a><span class="co">#&#39; @param baseline_data Data for the baseline risk estimates (probability of developing cancer), such as population-level risk from a cancer registry. Default data, for exemplary purposes, is for Colorectal cancer from the SEER database.</span></span>
<span id="cb2-6"><a href="#cb2-6" tabindex="-1"></a><span class="co">#&#39; @param max_age Integer, the maximum age considered for analysis. Default is 94.</span></span>
<span id="cb2-7"><a href="#cb2-7" tabindex="-1"></a><span class="co">#&#39; @param remove_proband Logical, indicating whether to remove probands from the analysis. Default is FALSE.</span></span>
<span id="cb2-8"><a href="#cb2-8" tabindex="-1"></a><span class="co">#&#39; @param age_imputation Logical, indicating whether to perform age imputation. Default is FALSE.</span></span>
<span id="cb2-9"><a href="#cb2-9" tabindex="-1"></a><span class="co">#&#39; @param median_max Logical, indicating whether to use the baseline median age or `max_age` as an upper bound for the median proposal. Default is TRUE.</span></span>
<span id="cb2-10"><a href="#cb2-10" tabindex="-1"></a><span class="co">#&#39; @param BaselineNC Logical, indicating that the non-carrier penetrance is assumed to be the baseline penetrance. Default is TRUE.</span></span>
<span id="cb2-11"><a href="#cb2-11" tabindex="-1"></a><span class="co">#&#39; @param var Numeric vector, variances for the proposal distribution in the Metropolis-Hastings algorithm. Default is `c(0.1, 0.1, 2, 2, 5, 5, 5, 5)`.</span></span>
<span id="cb2-12"><a href="#cb2-12" tabindex="-1"></a><span class="co">#&#39; @param burn_in Numeric, the fraction of results to discard as burn-in (0 to 1). Default is 0 (no burn-in).</span></span>
<span id="cb2-13"><a href="#cb2-13" tabindex="-1"></a><span class="co">#&#39; @param thinning_factor Integer, the factor by which to thin the results. Default is 1 (no thinning).</span></span>
<span id="cb2-14"><a href="#cb2-14" tabindex="-1"></a><span class="co">#&#39; @param imp_interval Integer, the interval at which age imputation should be performed when age_imputation = TRUE.</span></span>
<span id="cb2-15"><a href="#cb2-15" tabindex="-1"></a><span class="co">#&#39; @param distribution_data Data for generating prior distributions.</span></span>
<span id="cb2-16"><a href="#cb2-16" tabindex="-1"></a><span class="co">#&#39; @param prev Numeric, prevalence of the carrier status. Default is 0.0001.</span></span>
<span id="cb2-17"><a href="#cb2-17" tabindex="-1"></a><span class="co">#&#39; @param sample_size Optional numeric, sample size for distribution generation.</span></span>
<span id="cb2-18"><a href="#cb2-18" tabindex="-1"></a><span class="co">#&#39; @param ratio Optional numeric, ratio parameter for distribution generation.</span></span>
<span id="cb2-19"><a href="#cb2-19" tabindex="-1"></a><span class="co">#&#39; @param prior_params List, parameters for prior distributions.</span></span>
<span id="cb2-20"><a href="#cb2-20" tabindex="-1"></a><span class="co">#&#39; @param risk_proportion Numeric, proportion of risk for distribution generation.</span></span>
<span id="cb2-21"><a href="#cb2-21" tabindex="-1"></a><span class="co">#&#39; @param summary_stats Logical, indicating whether to include summary statistics in the output. Default is TRUE.</span></span>
<span id="cb2-22"><a href="#cb2-22" tabindex="-1"></a><span class="co">#&#39; @param rejection_rates Logical, indicating whether to include rejection rates in the output. Default is TRUE.</span></span>
<span id="cb2-23"><a href="#cb2-23" tabindex="-1"></a><span class="co">#&#39; @param density_plots Logical, indicating whether to include density plots in the output. Default is TRUE.</span></span>
<span id="cb2-24"><a href="#cb2-24" tabindex="-1"></a><span class="co">#&#39; @param plot_trace Logical, indicating whether to include trace plots in the output. Default is TRUE.</span></span>
<span id="cb2-25"><a href="#cb2-25" tabindex="-1"></a><span class="co">#&#39; @param penetrance_plot Logical, indicating whether to include penetrance plots in the output. Default is TRUE.</span></span>
<span id="cb2-26"><a href="#cb2-26" tabindex="-1"></a><span class="co">#&#39; @param penetrance_plot_pdf Logical, indicating whether to include PDF plots in the output. Default is TRUE.</span></span>
<span id="cb2-27"><a href="#cb2-27" tabindex="-1"></a><span class="co">#&#39; @param plot_loglikelihood Logical, indicating whether to include log-likelihood plots in the output. Default is TRUE.</span></span>
<span id="cb2-28"><a href="#cb2-28" tabindex="-1"></a><span class="co">#&#39; @param plot_acf Logical, indicating whether to include autocorrelation function (ACF) plots for posterior samples. Default is TRUE.</span></span>
<span id="cb2-29"><a href="#cb2-29" tabindex="-1"></a><span class="co">#&#39; @param probCI Numeric, probability level for credible intervals in penetrance plots. Must be between 0 and 1. Default is 0.95.</span></span>
<span id="cb2-30"><a href="#cb2-30" tabindex="-1"></a><span class="co">#&#39; @param sex_specific Logical, indicating whether to use sex-specific parameters in the analysis. Default is TRUE.</span></span></code></pre></div>
<div id="example" class="section level3">
<h3>Example</h3>
<p>To run the algorithm, we require the user to input:</p>
<ul>
<li>A single chain with 10k iterations of the adaptive MH algorithm. The
number of cores for the paralellization is set to
<code>ncores = 4</code>.</li>
<li>The pedigree data are the test family 1.</li>
<li>The prevalence is set at <code>prev = 0.0001</code>.</li>
<li>The <code>penetrance</code> function takes baseline age-specific
probabilitie of developing cancer as as input
<code>baseline_data</code>. In the default setting with
<code>BaselineNC = TRUE</code> this baseline is assumed to reflect the
non-carrier penetrance. For rare mutations this is considered a
reasonable assumption. The baseline_data must be a data frame with
baseline penetrance for females and males.</li>
</ul>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="co"># This is exemplary SEER penetrance data for Colorectal Cancer. </span></span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a>baseline_data_default <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a>  <span class="at">Age =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">94</span>,</span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a>  <span class="at">Female =</span> <span class="fu">c</span>(</span>
<span id="cb3-5"><a href="#cb3-5" tabindex="-1"></a>    <span class="fl">2.8e-07</span>, <span class="fl">9e-08</span>, <span class="fl">1e-08</span>, <span class="fl">3e-08</span>, <span class="fl">5e-08</span>, <span class="fl">7e-08</span>, <span class="fl">9e-08</span>, <span class="fl">7e-08</span>, <span class="fl">5e-08</span>, <span class="fl">4e-08</span>, <span class="fl">2e-08</span>, <span class="fl">4e-08</span>, <span class="fl">3.2e-07</span>, <span class="fl">6.3e-07</span>, <span class="fl">9.5e-07</span>, <span class="fl">1.27e-06</span>,</span>
<span id="cb3-6"><a href="#cb3-6" tabindex="-1"></a>    <span class="fl">1.94e-06</span>, <span class="fl">4.73e-06</span>, <span class="fl">7.88e-06</span>, <span class="fl">1.102e-05</span>, <span class="fl">1.417e-05</span>, <span class="fl">1.916e-05</span>, <span class="fl">3.517e-05</span>, <span class="fl">5.303e-05</span>, <span class="fl">7.088e-05</span>, <span class="fl">8.873e-05</span>, <span class="fl">0.00010961</span>,</span>
<span id="cb3-7"><a href="#cb3-7" tabindex="-1"></a>    <span class="fl">1.486e-04</span>, <span class="fl">1.906e-04</span>, <span class="fl">0.00023261</span>, <span class="fl">0.00027461</span>, <span class="fl">0.00032101</span>, <span class="fl">0.00039385</span>, <span class="fl">0.00047109</span>, <span class="fl">0.00054832</span>, <span class="fl">0.00062554</span>, <span class="fl">7.166e-04</span>,</span>
<span id="cb3-8"><a href="#cb3-8" tabindex="-1"></a>    <span class="fl">0.00089081</span>, <span class="fl">0.00107885</span>, <span class="fl">0.00126684</span>, <span class="fl">0.00145479</span>, <span class="fl">0.00163827</span>, <span class="fl">0.00179526</span>, <span class="fl">0.00194779</span>, <span class="fl">0.00210026</span>, <span class="fl">0.00225264</span>, <span class="fl">0.00239638</span>,</span>
<span id="cb3-9"><a href="#cb3-9" tabindex="-1"></a>    <span class="fl">0.00248859</span>, <span class="fl">0.00257215</span>, <span class="fl">0.00265562</span>, <span class="fl">0.00273901</span>, <span class="fl">0.00281841</span>, <span class="fl">0.00287439</span>, <span class="fl">0.00292639</span>, <span class="fl">0.00297831</span>, <span class="fl">0.00303014</span>, <span class="fl">0.00309486</span>,</span>
<span id="cb3-10"><a href="#cb3-10" tabindex="-1"></a>    <span class="fl">0.00323735</span>, <span class="fl">0.00339265</span>, <span class="fl">0.00354775</span>, <span class="fl">0.00370266</span>, <span class="fl">0.00385852</span>, <span class="fl">0.00402115</span>, <span class="fl">0.0041847</span>, <span class="fl">0.00434799</span>, <span class="fl">4.511e-03</span>, <span class="fl">0.00466219</span>,</span>
<span id="cb3-11"><a href="#cb3-11" tabindex="-1"></a>    <span class="fl">0.00474384</span>, <span class="fl">0.00481372</span>, <span class="fl">0.00488337</span>, <span class="fl">0.0049528</span>, <span class="fl">0.00500362</span>, <span class="fl">0.00494413</span>, <span class="fl">0.00486620</span>, <span class="fl">0.00478821</span>, <span class="fl">0.00471016</span>, <span class="fl">0.00462597</span>,</span>
<span id="cb3-12"><a href="#cb3-12" tabindex="-1"></a>    <span class="fl">0.00450511</span>, <span class="fl">0.00437818</span>, <span class="fl">0.00425130</span>, <span class="fl">0.00412450</span>, <span class="fl">0.00399836</span>, <span class="fl">0.00387577</span>, <span class="fl">0.00375380</span>, <span class="fl">0.00363187</span>, <span class="fl">0.00351002</span>, <span class="fl">0.00338186</span>,</span>
<span id="cb3-13"><a href="#cb3-13" tabindex="-1"></a>    <span class="fl">0.00321541</span>, <span class="fl">0.00304280</span>, <span class="fl">0.00287050</span>, <span class="fl">0.00269853</span>, <span class="fl">0.00253244</span>, <span class="fl">0.00239963</span>, <span class="fl">0.00227262</span></span>
<span id="cb3-14"><a href="#cb3-14" tabindex="-1"></a>  ),</span>
<span id="cb3-15"><a href="#cb3-15" tabindex="-1"></a>  <span class="at">Male =</span> <span class="fu">c</span>(</span>
<span id="cb3-16"><a href="#cb3-16" tabindex="-1"></a>    <span class="fl">2.8e-07</span>, <span class="fl">9e-08</span>, <span class="fl">1e-08</span>, <span class="fl">3e-08</span>, <span class="fl">5e-08</span>, <span class="fl">7e-08</span>, <span class="fl">9e-08</span>, <span class="fl">7e-08</span>, <span class="fl">5e-08</span>, <span class="fl">4e-08</span>, <span class="fl">2e-08</span>, <span class="fl">4e-08</span>, <span class="fl">3.2e-07</span>, <span class="fl">6.3e-07</span>, <span class="fl">9.5e-07</span>, <span class="fl">1.27e-06</span>,</span>
<span id="cb3-17"><a href="#cb3-17" tabindex="-1"></a>    <span class="fl">1.94e-06</span>, <span class="fl">4.73e-06</span>, <span class="fl">7.88e-06</span>, <span class="fl">1.102e-05</span>, <span class="fl">1.417e-05</span>, <span class="fl">1.916e-05</span>, <span class="fl">3.517e-05</span>, <span class="fl">5.303e-05</span>, <span class="fl">7.088e-05</span>, <span class="fl">8.873e-05</span>, <span class="fl">0.00010961</span>,</span>
<span id="cb3-18"><a href="#cb3-18" tabindex="-1"></a>    <span class="fl">1.486e-04</span>, <span class="fl">1.906e-04</span>, <span class="fl">0.00023261</span>, <span class="fl">0.00027461</span>, <span class="fl">0.00032101</span>, <span class="fl">0.00039385</span>, <span class="fl">0.00047109</span>, <span class="fl">0.00054832</span>, <span class="fl">0.00062554</span>, <span class="fl">7.166e-04</span>,</span>
<span id="cb3-19"><a href="#cb3-19" tabindex="-1"></a>    <span class="fl">0.00089081</span>, <span class="fl">0.00107885</span>, <span class="fl">0.00126684</span>, <span class="fl">0.00145479</span>, <span class="fl">0.00163827</span>, <span class="fl">0.00179526</span>, <span class="fl">0.00194779</span>, <span class="fl">0.00210026</span>, <span class="fl">0.00225264</span>, <span class="fl">0.00239638</span>,</span>
<span id="cb3-20"><a href="#cb3-20" tabindex="-1"></a>    <span class="fl">0.00248859</span>, <span class="fl">0.00257215</span>, <span class="fl">0.00265562</span>, <span class="fl">0.00273901</span>, <span class="fl">0.00281841</span>, <span class="fl">0.00287439</span>, <span class="fl">0.00292639</span>, <span class="fl">0.00297831</span>, <span class="fl">0.00303014</span>, <span class="fl">0.00309486</span>,</span>
<span id="cb3-21"><a href="#cb3-21" tabindex="-1"></a>    <span class="fl">0.00323735</span>, <span class="fl">0.00339265</span>, <span class="fl">0.00354775</span>, <span class="fl">0.00370266</span>, <span class="fl">0.00385852</span>, <span class="fl">0.00402115</span>, <span class="fl">0.0041847</span>, <span class="fl">0.00434799</span>, <span class="fl">4.511e-03</span>, <span class="fl">0.00466219</span>,</span>
<span id="cb3-22"><a href="#cb3-22" tabindex="-1"></a>    <span class="fl">0.00474384</span>, <span class="fl">0.00481372</span>, <span class="fl">0.00488337</span>, <span class="fl">0.0049528</span>, <span class="fl">0.00500362</span>, <span class="fl">0.00494413</span>, <span class="fl">0.00486620</span>, <span class="fl">0.00478821</span>, <span class="fl">0.00471016</span>, <span class="fl">0.00462597</span>,</span>
<span id="cb3-23"><a href="#cb3-23" tabindex="-1"></a>    <span class="fl">0.00450511</span>, <span class="fl">0.00437818</span>, <span class="fl">0.00425130</span>, <span class="fl">0.00412450</span>, <span class="fl">0.00399836</span>, <span class="fl">0.00387577</span>, <span class="fl">0.00375380</span>, <span class="fl">0.00363187</span>, <span class="fl">0.00351002</span>, <span class="fl">0.00338186</span>,</span>
<span id="cb3-24"><a href="#cb3-24" tabindex="-1"></a>    <span class="fl">0.00321541</span>, <span class="fl">0.00304280</span>, <span class="fl">0.00287050</span>, <span class="fl">0.00269853</span>, <span class="fl">0.00253244</span>, <span class="fl">0.00239963</span>, <span class="fl">0.00227262</span></span>
<span id="cb3-25"><a href="#cb3-25" tabindex="-1"></a>  )</span>
<span id="cb3-26"><a href="#cb3-26" tabindex="-1"></a>)</span></code></pre></div>
<ul>
<li>The specified parameters for the prior distributions are as per the
specification in the <code>prior_params_default</code> object (see
above).</li>
<li>The burn-in is set to <code>burn_in = 0.1</code>, which means the
first 1000 iterations of the chain will be discarded (given 10k
iterations of the algorithm).</li>
<li>The median age of onset of the baseline (non-carrier) penentrance is
set as the upper bound for the proposed median, given that
<code>median_max = TRUE</code>.</li>
<li>The automatic age imputation <code>AgeImputation</code> (see above)
is not applied in the, given that
<code>ageImputation = FALSE</code>.</li>
</ul>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a>output <span class="ot">&lt;-</span> <span class="fu">penetrance</span>(</span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a>    <span class="at">pedigree  =</span> dat, <span class="at">twins =</span> <span class="cn">NULL</span>, <span class="at">n_chains =</span> <span class="dv">1</span>, <span class="at">n_iter_per_chain =</span> <span class="dv">20000</span>,</span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a>   <span class="at">ncores =</span> <span class="dv">2</span>, <span class="at">baseline_data =</span> baseline_data_default, <span class="at">prev  =</span> <span class="fl">0.0001</span>, </span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a>    <span class="at">prior_params =</span> prior_params_default, <span class="at">burn_in =</span> <span class="fl">0.1</span>, <span class="at">median_max =</span> <span class="cn">TRUE</span>,</span>
<span id="cb4-5"><a href="#cb4-5" tabindex="-1"></a>    <span class="at">age_imputation =</span> <span class="cn">TRUE</span>, <span class="at">sex_specific =</span> <span class="cn">TRUE</span></span>
<span id="cb4-6"><a href="#cb4-6" tabindex="-1"></a>)</span></code></pre></div>
<p>The exemplary output from the estimation procedure can be seen
below.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="fu">plot_penetrance</span>(<span class="at">data =</span> output<span class="sc">$</span>combined_chains, <span class="at">prob =</span> <span class="fl">0.95</span>)</span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a><span class="fu">plot_pdf</span>(<span class="at">data =</span> output<span class="sc">$</span>combined_chains, <span class="at">prob =</span> <span class="fl">0.95</span>)</span></code></pre></div>
</div>
</div>
<div id="references" class="section level2">
<h2>References</h2>
<p>Andrieu C, Thoms J. A tutorial on adaptive MCMC. Stat Comput. 2008;
18(3):343–373. doi: 10.1007/s11222- 008-9110-y.</p>
<p>Golicher AR. clipp: Calculating Likelihoods by Pedigree Paring; 2023,
<a href="https://CRAN.R-project.org/package=clipp" class="uri">https://CRAN.R-project.org/package=clipp</a>, r package
version 1.7.0.</p>
<p>Haario H, Saksman E, Tamminen J. An adaptive Metropolis algorithm.
Bernoulli. 2001; 7(2):223–242.</p>
<p>Lange K, Elston RC. Extensions to pedigree analysis I. Likehood
calculations for simple and complex pedigrees. Hum Hered.
1975;25(2):95-105.</p>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
